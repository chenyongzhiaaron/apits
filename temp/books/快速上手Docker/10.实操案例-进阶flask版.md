# 实操案例

## 1. 目的

上一节中已经完成了`flask`开发环境操作，但是发现有了很多次的Dockerfile才完成，这是很麻烦的，为了更加方便的操作使用，我们本小节将对上一节的之后进行升级为一个`Dockerfile`

## 2. 实现

将基础班中的5个`Dockerfile`文件合并为一个，名字叫做`Dockerfile_2.0` 适当修改后如下：

```dockerfile
FROM ubuntu:16.04

# 复制国内更新源
COPY sources.list /etc/apt/sources.list

# 跳转到指定目录
WORKDIR /home

# 复制文件到容器
COPY requirements.txt .

# 安装vim、python3、pip3以及flask用的包
RUN apt-get update && apt-get install vim -y \
    && apt-get install python3 -y \
    && apt-get install python3-pip -y \
    && pip3 install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple

# 复制flask示例py文件
COPY main.py .

# 对外暴露端口
EXPOSE 8899

# 运行测试项目
CMD ["python3","main.py"]
```

命令：

```
docker build -t ubuntu_flask:2.0 . -f Dockerfile_2.0
```

效果：

<img src="assets/image-20201214213507761.png" alt="image-20201214213507761" style="zoom:50%;" />

<img src="assets/image-20201214214735551.png" alt="image-20201214214735551" style="zoom:50%;" />