# 容器互联

## 1. 引入

当真实部署一个web项目时肯定需要用到多个容器之间进行数据通信，此时就是所谓的`容器互联`

![Xnip2019-11-26_20-16-41](assets/Xnip2019-11-26_20-16-41.png)

## 2. 使用默认网络

当使用如下命令时，会看到如下图示效果

```
docker network ls
```

![image-20191126222138978](assets/image-20191126222138978.png)

说明：

默认情况下，docker会有3种网络方式，bridge、host、null，除此以外还有其他的方式 一般很少使用。

### bridge（网桥）方式

![img](assets/697113-20160921210314981-2013047548.jpg)

在这种方式下，默认会把所有的容器链接到一起，这也就是为什么能够在一个容器中`ping`通另外一个容器了

### 查看方式

可以使用

```
docker network inspect 网络id
```

查看这个网络中所有的容器ip以及其他信息

![image-20191126222948670](assets/image-20191126222948670.png)

当我们在使用docker-compose构建服务时，会自动创建一个新的网络如下

![image-20191126223308392](assets/image-20191126223308392.png)

查看各服务（容器）的ip信息

![image-20191126223432709](assets/image-20191126223432709.png)



## 3. 使用自定义网络

为了更方便的使用网络，可以自己进行创建并使用这个网络

### 新建网络

下面先创建一个新的 Docker 网络。

```bash
$ docker network create -d bridge my-net
```

`-d` 参数指定 Docker 网络类型，有 `bridge` `overlay`等

![image-20191126223925499](assets/image-20191126223925499.png)

### 连接容器

运行一个容器并连接到新建的 `my-net` 网络

```bash
docker run --rm -it --network my-net my_flask:1.0 bash
```

打开新的终端，再运行一个容器并加入到 `my-net` 网络

```bash
docker run --rm -it --network my-net my_flask:1.0 bash
```

再打开一个新的终端查看容器信息

```bash
$ docker container ls
```

<img src="assets/image-20201216210121082.png" alt="image-20201216210121082" style="zoom:50%;" />

可以通过如下方式进行检查

<img src="assets/image-20201216210436297.png" alt="image-20201216210436297" style="zoom:50%;" />