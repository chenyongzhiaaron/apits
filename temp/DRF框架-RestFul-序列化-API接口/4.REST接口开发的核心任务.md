# REST接口开发的核心任务

**本小节学习目标**：
* 理解序列化和反序列化的概念
* 理解RestAPI开发的核心工作

## RestAPI开发核心工作

分析上节图书管理的5个API接口，可以发现，在开发REST API接口时，视图中做的最主要有三件事：

* 将请求的数据（如JSON格式）转换为模型类对象
* 操作数据库
* 将模型类对象转换为响应的数据（如JSON格式）

### 1. 序列化Serialization

在以上操作中，涉及到两个概念：**序列化和反序列化**。

1）序列化

**将程序中的一个数据结构类型转换为其他格式（字典、JSON、XML等），例如将Django中的模型类对象转换为字典或JSON字符串，这个转换过程我们称为序列化。**

如：

```python
queryset = BookInfo.objects.all()
book_list = []
# 序列化
for book in queryset:
    book_list.append({
        'id': book.id,
        'btitle': book.btitle,
        'bpub_date': book.bpub_date,
        'bread': book.bread,
        'bcomment': book.bcomment,
        'image': book.image.url if book.image else ''
    })
return JsonResponse(book_list, safe=False)
```

2）反序列化

**将其他格式（字典、JSON、XML等）转换为程序中的数据，例如将JSON字符串或字典转换保存为Django中的模型类对象，这个过程我们称为反序列化。**

如：

```python
json_bytes = request.body
json_str = json_bytes.decode()

# 反序列化
book_dict = json.loads(json_str)
book = BookInfo.objects.create(
    btitle=book_dict.get('btitle'),
    bpub_date=book_dict.get('bpub_date')
)
```

通过上节课的例子可以看到，**在开发REST API时，视图中要频繁的进行序列化与反序列化的操作。**

> 注：[维基百科](https://zh.wikipedia.org/wiki/%E5%BA%8F%E5%88%97%E5%8C%96)中对于序列化的定义。

### 2. RestAPI核心工作说明

在开发REST API接口时，我们在**视图**中在做的最核心的事是：

* **将数据库数据序列化为前端所需要的格式，并返回。**

* **将前端发送的数据反序列化保存到模型类对象，并保存到数据库中。**

**总结**：
* 序列化：将对象转换为字典或者json的过程。
* 反序列化：将字典或json转换保存到对象中的过程。
* RestAPI核心工作：
  * 将数据库数据序列化为前端所需要的格式，并返回。
  * 将前端发送的数据反序列化保存到模型类对象，并保存到数据库中。
