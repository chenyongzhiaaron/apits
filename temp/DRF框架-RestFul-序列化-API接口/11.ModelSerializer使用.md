# ModelSerializer

**本小节学习目标**：
* 理解ModelSerializer和Serializer的区别
* 掌握ModelSerializer的基本使用

## ModelSerializer使用

如果序列化器类对应的是Django的某个模型类，则定义序列化器类时，可以直接继承于ModelSerializer。

ModelSerializer是Serializer类的子类，相对于Serializer，提供了以下功能：
* 基于模型类字段自动生成序列化器类的字段
* 包含默认的create()和update()方法的实现

### 1. 基本使用

创建一个BookInfoSerializer类：

```python
class BookInfoSerializer(serializers.ModelSerializer):
    """图书数据序列化器"""
    class Meta:
        model = BookInfo
        fields = '__all__'
```

* model：指明序列化器类对应的模型类
* fields：指明依据模型类的哪些字段生成序列化器类的字段

可以在python manage.py shell中查看的BookInfoSerializer自动生成的具体字段：

```python
>>> from booktest.serializers import BookInfoSerializer
>>> serializer = BookInfoSerializer()
>>> serializer
BookInfoSerializer():
    id = IntegerField(label='ID', read_only=True)
    btitle = CharField(label='名称', max_length=20)
    bpub_date = DateField(label='发布日期')
    bread = IntegerField(label='阅读量', max_value=2147483647, min_value=-2147483648, required=False)
    bcomment = IntegerField(label='评论量', max_value=2147483647, min_value=-2147483648, required=False)
```

### 2. 指定字段

1) 使用**fields**来指明依据模型类的哪些字段生成序列化器类的字段，`__all__`表明包含所有字段，也可以指明具体哪些字段，如：

```python
class BookInfoSerializer(serializers.ModelSerializer):
    """图书数据序列化器"""
    class Meta:
        model = BookInfo
        fields = ('id', 'btitle', 'bpub_date', 'bread', 'bcomment')
```

2) 使用**exclude**可以指明排除哪些字段，如：

```python
class BookInfoSerializer(serializers.ModelSerializer):
    """图书数据序列化器"""
    class Meta:
        model = BookInfo
        exclude = ('is_delete',)
```

### 3. 添加和修改选项参数

可以使用**extra_kwargs**参数为自动生成的序列化器类字段添加或修改原有的选项参数。

```python
class BookInfoSerializer(serializers.ModelSerializer):
    """图书数据序列化器"""
    class Meta:
        model = BookInfo
        fields = ('id', 'btitle', 'bpub_date', 'bread', 'bcomment')
        extra_kwargs = {
            'bread': {'min_value': 0, 'required': True},
            'bcomment': {'min_value': 0, 'required': True},
            'bpub_date': {'required': True}
        }

# BookInfoSerializer():
#    id = IntegerField(label='ID', read_only=True)
#    btitle = CharField(label='名称', max_length=20)
#    bpub_date = DateField(label='发布日期', required=True)
#    bread = IntegerField(label='阅读量', max_value=2147483647, min_value=0, required=True)
#    bcomment = IntegerField(label='评论量', max_value=2147483647, min_value=0, required=True)
```

**总结**：
* ModelSerializer使用
  * 如果序列化器类对应的是Django的模型类，可以直接继承ModelSerializer
  * 继承ModelSerializer之后，可以依据模型类字段自动生成序列化器的字段
  * ModelSerializer中已经实现了create和update方法
