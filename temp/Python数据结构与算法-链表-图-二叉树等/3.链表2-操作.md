# 链表操作

## 1. 三种基本操作

### 删除操作

![1570723505115](assets/1570723505115.png)

### 插入操作

![1570723469548](assets/1570723469548.png)

### 查询操作

链表的随机访问第 k 个元素，必须根据指针一个结点一个结点地依次遍历，直到找到相应的结点。

对于一个有序链表，双向链表的按值查询的效率会比单链表高一些。记录上次查找的位置 p，每次查询时，根据要查找的值与 p 的大小关系，决定是往前还是往后查找，双向链表平均只需要查找一半的数据。



## 2. 单链表示例

```python
class SingleNode:
    def __init__(self, item):
        """
        完成初始的设定
        """
        self.item = item  # 存储数据
        self.next = None  # 存储下一个节点的地址


class SingleLink:
    def __init__(self):
        """
        完成初始列表的创建，即空列表
        """
        self.__head = None  # 谁都不指向，表示空链表

    def __str__(self):
        """
        遍历链表
        """
        print("遍历列表...开始...")
        temp = self.__head
        while temp != None:
            print(temp.item)
            temp = temp.next
        print("遍历列表...结束...")
        return ""

    def insert(self, old_item, item):
        """
        在指节点位置前 插入新节点
        """
        # 创建新节点
        new_single_node = SingleNode(item)
        # 查询需要的节点
        temp = self.__head
        prev = None
        while temp != None:
            if temp.item == old_item:
                if temp == self.__head:
                    # 如果是头节点
                    new_single_node.next = self.__head
                    self.__head = new_single_node
                else:
                    prev.next = new_single_node
                    new_single_node.next = temp
                break
            
            # 向后移动位置
            prev = temp
            temp = temp.next
        else:
            # 如果需要查询的元素节点不存在，那么就在末尾添加
            prev.next = new_single_node

    def add_first(self, item):
        """
        在链表头 前面添加新节点
        """
        # 创建一个新节点
        new_single_node = SingleNode(item)
        
        # 将新节点的next指向原链表的头节点
        new_single_node.next = self.__head

        # 更新头节点
        self.__head = new_single_node

    def append(self, item):
        """
        向链表末尾添加数据
        """
        # 创建一个新节点
        new_single_node = SingleNode(item)
        # 将新节点添加到现有链表的末尾
        # 情况1：如果是空链表, 则刚刚创建的节点就是整个链表的头结点
        if not self.__head:
            self.__head = new_single_node
            return

        # 先找到末尾
        temp = self.__head
        while temp.next != None:
            temp = temp.next
        # 然后再添加
        temp.next = new_single_node

    def search(self, item):
        """
        搜索指定的数据
        """
        temp = self.__head
        while temp != None:
            if temp.item == item:
                return True  # 找到了需要的元素
            temp = temp.next
        return False  # 没有找到

    def remove(self, item):
        """
        删除指定的元素
        """
        temp = self.__head
        prev = None
        while temp != None:
            if temp.item == item:
                if temp == self.__head:
                    # 如果是头节点
                    self.__head = self.__head.next
                else:
                    # 如果不是头节点
                    prev.next = temp.next
                return True  # 表示删除了需要删除的节点。当本函数执行结束后temp这个局部变量就会被释放，从而导致刚刚查询到的头节点就没有了引用，从而会出发GC进行垃圾回收，从而删除了这个没有用处的节点
            
            prev = temp  # 保存刚刚的遍历节点
            temp = temp.next  # 保存下一个节点
        
        return False  # 表示删除失败

if __name__ == "__main__":
    # 创建一个单链表
    single_link = SingleLink()

    # 遍历列表
    print(single_link)

    # 末尾添加数据
    single_link.append(55)
    single_link.append(66)
    single_link.append(77)

    # 遍历列表
    print(single_link)

    # 查询是否有需要的数据
    ret = single_link.search(77)
    print("是否找到需要的数据:", ret)

    # 删除指定的数据
    ret = single_link.remove(77)
    print("是否删除需要的数据:", ret)

    print(single_link)

    # 在链表头添加新节点
    single_link.add_first(100)

    print(single_link)

    single_link.append(200)

    print(single_link)

    # 在指定节点前插入新节点
    single_link.insert(55, 99)

    print(single_link)

```

使用Python3运行结果如下：

```
遍历列表...开始...
遍历列表...结束...

遍历列表...开始...
55
66
77
遍历列表...结束...

是否找到需要的数据: True
是否删除需要的数据: True
遍历列表...开始...
55
66
遍历列表...结束...

遍历列表...开始...
100
55
66
遍历列表...结束...

遍历列表...开始...
100
55
66
200
遍历列表...结束...

遍历列表...开始...
100
99
55
66
200
遍历列表...结束...
```







