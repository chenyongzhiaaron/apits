 # Git单人本地仓库操作

* 课程目标：学习常用的Git终端命令
* 提示：本地仓库是个`.git`隐藏文件

> 以下为演示Git单人本地仓库操作

* **1.安装git**

    ```
    sudo apt-get install git
    密码：chuanzhi
    ```

    ![](./assets/安装Git.png)

* **2.查看git安装结果**

    ```
    git
    ```

* **3.创建项目**
    * 在桌面创建`test`文件夹，表示是工作项目

        ```
        Desktop/test/
        ```

* **4.创建本地仓库**
    * 进入到`test`，并创建本地仓库`.git`
    * 新创建的本地仓库`.git`是个空仓库

        ```
        cd Desktop/test/
        git init
        ```

      ![](./assets/创建本地仓库.png)

    * 创建本地仓库`.git`后

        ![](./assets/空仓库.png)

* **5.配置个人信息**

    ```
    git config user.name '张三'
    git config user.email 'zhangsan@163.com'
    ```

    ![](./assets/配置个人信息.png)

    * 配置个人信息后

        ![](./assets/配置个人信息后.png)
        
> 默认不配置的话，会使用全局配置里面的用户名和邮箱
> 全局git配置文件路径：~/.gitconfig

* **6.新建py文件**
    * 在项目文件`test`里面创建`login.py`文件，用于版本控制演示

        ![](./assets/项目文件详情.png)

* **7.查看文件状态**
    * 红色表示新建文件或者新修改的文件,都在工作区.
    * 绿色表示文件在暂存区
    * 新建的`login.py`文件在工作区，需要添加到暂存区并提交到仓库区

    ```
    git status
    ```

    ![](./assets/查看文件状态.png)

* **8.将工作区文件添加到暂存区**

    ```
    # 添加项目中所有文件
    git add .
    或者
    # 添加指定文件
    git add login.py
    ```

    ![](./assets/添加到暂存区.png)

* **9.将暂存区文件提交到仓库区**
    * `commit`会生成一条版本记录
    * `-m`后面是版本描述信息

    ```
    git commit -m '版本描述'
    ```

    ![](./assets/提交到仓库区.png)

* **10.接下来就可以在`login.py`文件中编辑代码**
    * 代码编辑完成后即可进行`add`和`commit`操作
    * 提示：添加和提交合并命令

        ```
        git commit -am "版本描述"
        ```

    * 提交两次代码，会有两个版本记录

        ![](./assets/两次版本提交.png)

* **11.查看历史版本**

    ```
    git log
    或者
    git reflog
    ```

    ![](./assets/查看历史记录log.png)

> git reflog 可以查看所有分支的所有操作记录（包括commit和reset的操作），包括已经被删除的commit记录，git log 则不能察看已经删除了的commit记录

* **12.回退版本**
    * **方案一：**
        * `HEAD`表示当前最新版本
        * `HEAD^`表示当前最新版本的前一个版本
        * `HEAD^^`表示当前最新版本的前两个版本，**以此类推...**
        * `HEAD~1`表示当前最新版本的前一个版本
        * `HEAD~10`表示当前最新版本的前10个版本，**以此类推...**

       ```
       git reset --hard HEAD^
       ```

       ![](./assets/回退版本HEAD.png)

       ![](./assets/回退版本后HEAD.png)

    * **方案二：当版本非常多时可选择的方案**
        * 通过每个版本的版本号回退到指定版本

            ```
            git reset --hard 版本号
            ```

            ![](./assets/回退版本版本号.png)

            ![](./assets/回退版本后版本号.png)

* **13.撤销修改**
    * 只能撤销工作区、暂存区的代码,不能撤销仓库区的代码
    * 撤销仓库区的代码就相当于回退版本操作

        * 撤销工作区代码
            * 新加代码`num3 = 30`，不`add`到暂存区，保留在工作区

            ```
            git checkout 文件名
            ```

            ![](./assets/撤销工作区代码前.png)

            ![](./assets/撤销工作区代码后.png)

        * 撤销暂存区代码
            * 新加代码`num3 = 30`，并`add`到暂存区

            ```
            # 第一步：将暂存区代码撤销到工作区
            git reset HEAD  文件名
            # 第二步：撤销工作区代码
            git checkout 文件名
            ```

            ![](./assets/撤销暂存区代码.png)

* **14.对比版本**

    * 对比版本库与工作区
        * 新加代码`num3 = 30`，不`add`到暂存区，保留在工作区
        * `git diff HEAD -- login.py`

            ![](./assets/对比版本库与工作区.png)

    * 对比版本库
        * 新加代码`num3 = 30`，并`add`到暂存区
        * `git diff HEAD HEAD^ -- login.py`

            ![](./assets/对比版本库.png)

* **15.删除文件**：删除文件分为确定删除和误删
    * 在项目中新建`test.py`文件，并添加和提交到仓库

        * 确定删除处理：
            
            ```
            # 删除文件
            rm 文件名
            # git确定删除文件，对比添加文件git add 
            git rm 文件名
            # 删除后记录删除操作版本
            git commit -m '删除描述'
            ```

            ![](./assets/确定删除处理.png)

        * 误删处理：撤销修改即可
            
            ```
            # 删除文件
            rm 文件名
            # git撤销修改
            git checkout -- 文件名
            ```
            
            ![](./assets/误删处理.png)
